box: python:2.7-onbuild
build:
  steps:
    - pip-install
    - script:
        name: test empty run to catch import errors
        code: |
          python run.py
    - script:
        name: copy to /usr/src/app working dir
        code: |
          cp -R $WERCKER_ROOT/* /usr/src/app
    - internal/docker-push:
        cmd: python run.py
        working-dir: /usr/src/app
        tag: latest, $WERCKER_GIT_COMMIT, $WERCKER_GIT_BRANCH
        username: _json_key
        password: $GCR_JSON_KEY_FILE
        repository: $GCR_REPO
        registry: $GCR_HOST
